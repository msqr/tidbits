<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>

	<query name="TidbitAll">
		<![CDATA[from magoffin.matt.tidbits.domain.Tidbit Tidbit
		order by lower(Tidbit.Name), lower(Tidbit.Kind.Name)]]>
	</query>
	
	<query name="TidbitAllCount">
		<![CDATA[select count(*) from magoffin.matt.tidbits.domain.Tidbit]]>
	</query>
	
	<query name="TidbitsForName">
		<![CDATA[from magoffin.matt.tidbits.domain.Tidbit Tidbit 
		where Tidbit.Name = ?]]>
	</query>

	<query name="TidbitsForNameStartsWith">
		<![CDATA[from magoffin.matt.tidbits.domain.Tidbit Tidbit 
		where lower(Tidbit.Name) like lower(? || '%')]]>
	</query>
	
	<query name="TidbitKindAll">
		<![CDATA[from magoffin.matt.tidbits.domain.TidbitKind TidbitKind
		order by lower(TidbitKind.Name)]]>
	</query>
	
	<query name="TidbitKindForName">
		<![CDATA[from magoffin.matt.tidbits.domain.TidbitKind TidbitKind
		where lower(TidbitKind.Name) = lower(?)]]>
	</query>
	
	<query name="TidbitKindsForName">
		<![CDATA[from magoffin.matt.tidbits.domain.TidbitKind TidbitKind
		where lower(TidbitKind.Name) like lower('%' || ? || '%')
		order by lower(TidbitKind.Name)]]>
	</query>
	
	<query name="TidbitUpdateKindReassign">
		<![CDATA[update magoffin.matt.tidbits.domain.Tidbit
			set Kind = (from magoffin.matt.tidbits.domain.TidbitKind Kind1 where Kind1.KindId = :reassignKindId)
			where Kind.KindId = (select Kind2.KindId from magoffin.matt.tidbits.domain.TidbitKind Kind2 where Kind2.KindId = :originalKindId)]]>
	</query>
	
</hibernate-mapping>
